## 인덱스(index)란?

인덱스란 추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조이다. 데이터베이스는 책의 색인과 같다고 생각하면 편하다. 정보를 찾을때 모든 정보를 처음부터 끝까지 서치할 필요 없이 색인을 통해 데이터의 위치를 포함한 자료구조를 생성하여 빠르게 조회할 수 있게 도와준다.

### 인덱스의 장단점

- 장점

  테이블을 조회하는 속도와 그에 따른 성능을 향상시킬 수 있다.
  전반적인 시스템의 부하를 줄일 수 있다.

- 단점

  인덱스를 관리하기 위해 DB의 약 10%에 해당하는 저장공간이 필요하다.
  인덱스를 관리하기 위해 추가 작업이 필요하다.
  인덱스를 잘못 사용할 경우 오히려 성능이 저하되는 역효과가 발생할 수 있다.

### 인덱스의 자료구조

- 해시 테이블

  해시 테이블은 (Key, Value)로 데이터를 저장하는 자료구조 중 하나로 빠른 데이터 검색이 필요할 때 유용하다. 해시 테이블은 Key 값을 이용해 고유한 index를 생성하여 그 index에 저장된 값을 꺼내오는 구조이다.

  해시의 시간복잡도는 O(1) 이지만 해시가 등호(=)연산에만 특화되어있어 제한적으로 쓰인다. 또한, 해시 충돌에 대한 비용이 발생하여 최악의 경우 O(N)이 될 수 있다.

  이러한 단점으로 속도는 빠르지만 B+Tree 인덱스가 일반적으로 사용된다.

- B+Tree

  B+Tree는 B-Tree에서 리프노드들을 LinkedList로 연결하여 부등호 연산에 이점을 갖게 인덱스에 최적화 하였다. 

  B+Tree의 시간복잡도는 O(𝑙𝑜𝑔2𝑛)이다. B+Tree에 대한 설명은 다음 영상을 참고했다.

  https://youtu.be/iNvYsGKelYs?si=qtzUuDukeS6v_Zl2

### 인덱스보다 Full Scan이 더 빠르다?

- Full Scan은 테이블에 존재하는 모든 데이터를 읽어 가면서 조건에 맞으면 결과로서 추출하고 맞지 않으면 버리는 방식이다.
- DB는 기본적으로 데이터들을 Disk에 저장하고, 읽어 올 땐 내부 버퍼 캐시에 데이터가 없는 경우 Disk I/O를 발생시켜 데이터를 읽어 온 뒤, 이를 DB 내부 버퍼 캐시에 적재하여 다양한 처리를 진행한다. 여기서 Disk I/O의 최소 단위가 되는것이 Block이다. 인덱스는 이 Block 내에 저장된다.
- 일반적으로 블록들은 서로 인접되어 있기 때문에, Full Scan은 한번의 I/O에 여러 블록을 옮겨온다(Multi Block I/O). 반대로 인덱스는 인덱스의 논리적 구조에 의존한 채 정렬된 인덱스를 순차적으로 탐색하는 스캔 방식이다. 인덱스는 항상 정렬된 상태를 유지하는 자료구조를 갖는데, 여기에서의 정렬의 개념이 특정 블록 레벨(물리적)에서는 무의미해진다. 즉, 하나의 인덱스 구조에 대한 요소들은 여러 Block에 나뉘어 저장되고 이는 인덱스의 논리적 정렬된 순서와 상관이 없다는 의미다. 따라서 논리적으로 정렬된 인덱스 구조를 따라 탐색을 진행하려면 한번에 하나의 Block 만을 읽어가며 확인을 해야한다.(Single Block I/O).
- 이러한 이유로 테이블의 데이터가 많지 않은 상황, 넓은 범위의 데이터 액세스 같은 상황에서는 인덱스 사용보다 Full Table Scan이 한번에 여러 Block들을 읽어와서 유리할 수 있다.
